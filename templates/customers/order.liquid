{{ 'customer.css' | asset_url | stylesheet_tag }}

<div class="order page-width account-template">
  {% render 'account-menu' %}

  <div class="account-template__content">
    <svg style="display:none">
      <symbol id="icon-discount" viewBox="0 0 12 12">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M7 0h3a2 2 0 012 2v3a1 1 0 01-.3.7l-6 6a1 1 0 01-1.4 0l-4-4a1 1 0 010-1.4l6-6A1 1 0 017 0zm2 2a1 1 0 102 0 1 1 0 00-2 0z" fill="currentColor"></path>
      </symbol>
    </svg>
    <div>
      {% if settings.order_prev_text != blank %}
        <a href="{{ settings.order_prev_link }}">{{ settings.order_prev_text }}</a>
      {% endif %}

      <h1>{{ 'customer.order.title' | t: name: order.name }}</h1>
    </div>

    <div>
      <h2>{{ 'customer.order.items_title' | t }}</h2>
      {%- if order.cancelled -%}
        {%- assign cancelled_at = order.cancelled_at | time_tag: format: "date_at_time" -%}
        <p>{{ 'customer.order.cancelled_html' | t: date: cancelled_at }}</p>
        <p>{{ 'customer.order.cancelled_reason' | t: reason: order.cancel_reason_label }}</p>
      {%- endif -%}

      <ul class="order__items">
        {%- for line_item in order.line_items -%}
          <li class="order-item">
            <div class="line_item__image-container">
              {% if line_item.image != blank %}
                <img src="{{ line_item.image | image_url: width: 198 }}"
                     class="line_item__image"
                     alt="{{ line_item.image.alt | escape }}"
                     loading="lazy"
                     width="99"
                     height="{{ 99 | divided_by: item.image.aspect_ratio | ceil }}"
                >
              {% else %}
                {{ 'product-1' | placeholder_svg_tag: "line_item__svg-image" }}
              {% endif %}
            </div>

            <div class="line_item__content-container">
              <h3 class="line_item__title">{{ line_item.title | escape }}</h3>
              {% render 'price-order', line_item: line_item %}
              <p class="order-item_quantity">{{ 'customer.order.quantity' | t }}: {{ line_item.quantity }}</p>
            </div>
          </li>
        {%- endfor -%}
      </ul>

      <h2>{{ 'customer.order.order_summary_title' | t }}</h2>

      <table role="table" class="order-details">
        <caption class="visually-hidden">{{ 'customer.order.title' | t: name: order.name }}</caption>
        <tr role="row">
          <td id="RowSubtotal" role="rowheader" scope="row">
            {{ 'customer.order.subtotal' | t }}
          </td>
          <td headers="RowSubtotal" role="cell" data-label="{{ 'customer.order.subtotal' | t }}">{{ order.line_items_subtotal_price | money }}</td>
        </tr>
        {%- if order.cart_level_discount_applications != blank -%}
          <tr role="row">
            {%- for discount_application in order.cart_level_discount_applications -%}
              <td id="RowDiscount" role="rowheader" scope="row">
                {{ 'customer.order.discount' | t }}
                <span class="cart-discount">
                  <svg aria-hidden="true" focusable="false" viewBox="0 0 12 12">
                    <use href="#icon-discount" />
                  </svg>
                  {{- discount_application.title -}}
                </span>
              </td>
              <td headers="RowDiscount" role="cell" data-label="{{ 'customer.order.discount' | t }}">
                <div>
                  <span>-{{ discount_application.total_allocated_amount | money }}</span>
                  <span class="cart-discount">
                    <svg aria-hidden="true" focusable="false" viewBox="0 0 12 12">
                      <use href="#icon-discount" />
                    </svg>
                    {{- discount_application.title -}}
                  </span>
                </div>
              </td>
            {%- endfor -%}
          </tr>
        {%- endif -%}
        {%- for shipping_method in order.shipping_methods -%}
          <tr role="row">
            <td id="RowShipping" role="rowheader" scope="row">{{ 'customer.order.shipping' | t }} ({{ shipping_method.title }})</td>
            <td headers="RowShipping" role="cell" data-label="{{ 'customer.order.shipping' | t }} ({{ shipping_method.title }})">{{ shipping_method.price | money }}</td>
          </tr>
        {%- endfor -%}
        {%- for tax_line in order.tax_lines -%}
          <tr role="row">
            <td id="RowTax" role="rowheader" scope="row">{{ 'customer.order.tax' | t }} ({{ tax_line.title }} {{ tax_line.rate | times: 100 }}%)</td>
            <td headers="RowTax" role="cell" data-label="{{ 'customer.order.tax' | t }} ({{ tax_line.title }} {{ tax_line.rate | times: 100 }}%)">{{ tax_line.price | money }}</td>
          </tr>
        {%- endfor -%}
        {%- if order.total_duties -%}
          <tr role="row">
            <td id="RowDuties" role="rowheader" scope="row">{{ 'customer.order.total_duties' | t }}</td>
            <td headers="RowDuties" role="cell" data-label="{{ 'customer.order.total_duties' | t }}">{{ order.total_duties | money }}</td>
          </tr>
        {%- endif -%}
        <tr role="row">
          <td id="RowTotal" role="rowheader" scope="row">{{ 'customer.order.total' | t }}</td>
          <td headers="RowTotal" role="cell" data-label="{{ 'customer.order.total' | t }}">{{ order.total_price | money_with_currency }}</td>
        </tr>
      </table>

      <h2>{{ 'customer.order.order_information_title' | t }}</h2>
      <div>
        <div>
          <h2>{{ 'customer.order.shipping_address' | t }}</h2>
          <p>
            <strong>{{ 'customer.order.fulfillment_status' | t }}:</strong>
            {{ order.fulfillment_status_label }}
          </p>
          {{ order.shipping_address | format_address }}
        </div>

        <div>
          <h2>{{ 'customer.order.shipping_method' | t }}</h2>
          {%- for shipping_method in order.shipping_methods -%}
            <div role="row">
              <div>{{ 'customer.order.shipping' | t }} ({{ shipping_method.title }})</div>
              <div>{{ shipping_method.price | money }}</div>
            </div>
          {%- endfor -%}
          ++++
          <p>
            <strong>{{ customer.order.shipping_method.title }}:</strong>
          </p>
        </div>

        <div>
          <h2>{{ 'customer.order.billing_address' | t }}</h2>
          <p>
            <strong>{{ 'customer.order.payment_status' | t }}:</strong>
            {{ order.financial_status_label }}
          </p>
          {{ order.billing_address | format_address }}
        </div>
      </div>
    </div>
  </div>
</div>
